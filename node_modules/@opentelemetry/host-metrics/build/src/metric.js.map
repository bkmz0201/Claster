{"version":3,"file":"metric.js","sourceRoot":"","sources":["../../src/metric.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseMetrics } from './BaseMetrics';\nimport {\n  BatchObservableResult,\n  ObservableCounter,\n  ObservableGauge,\n} from '@opentelemetry/api';\nimport {\n  ATTR_NETWORK_IO_DIRECTION,\n  ATTR_PROCESS_CPU_STATE,\n  ATTR_SYSTEM_CPU_LOGICAL_NUMBER,\n  ATTR_SYSTEM_CPU_STATE,\n  ATTR_SYSTEM_DEVICE,\n  ATTR_SYSTEM_MEMORY_STATE,\n  METRIC_PROCESS_CPU_TIME,\n  METRIC_PROCESS_CPU_UTILIZATION,\n  METRIC_PROCESS_MEMORY_USAGE,\n  METRIC_SYSTEM_CPU_TIME,\n  METRIC_SYSTEM_CPU_UTILIZATION,\n  METRIC_SYSTEM_MEMORY_USAGE,\n  METRIC_SYSTEM_MEMORY_UTILIZATION,\n  METRIC_SYSTEM_NETWORK_ERRORS,\n  METRIC_SYSTEM_NETWORK_IO,\n  NETWORK_IO_DIRECTION_VALUE_RECEIVE,\n  NETWORK_IO_DIRECTION_VALUE_TRANSMIT,\n  PROCESS_CPU_STATE_VALUE_SYSTEM,\n  PROCESS_CPU_STATE_VALUE_USER,\n  SYSTEM_CPU_STATE_VALUE_IDLE,\n  SYSTEM_CPU_STATE_VALUE_INTERRUPT,\n  SYSTEM_CPU_STATE_VALUE_NICE,\n  SYSTEM_CPU_STATE_VALUE_SYSTEM,\n  SYSTEM_CPU_STATE_VALUE_USER,\n  SYSTEM_MEMORY_STATE_VALUE_FREE,\n  SYSTEM_MEMORY_STATE_VALUE_USED,\n} from './semconv';\n\nimport {\n  getCpuUsageData,\n  getMemoryData,\n  getProcessCpuUsageData,\n  getProcessMemoryData,\n} from './stats/common';\nimport { getNetworkData } from './stats/si';\nimport type { CpuUsageData, MemoryData, ProcessCpuUsageData } from './types';\nimport type { Systeminformation } from 'systeminformation';\n\n/**\n * Metrics Collector - collects metrics for CPU, Memory, Network\n */\nexport class HostMetrics extends BaseMetrics {\n  private _batchUpdateCpuUsages(\n    observableResult: BatchObservableResult,\n    cpuUsages: CpuUsageData[]\n  ): void {\n    for (let i = 0, j = cpuUsages.length; i < j; i++) {\n      const cpuUsage = cpuUsages[i];\n      observableResult.observe(this._cpuTime, cpuUsage.user, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_USER,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n      observableResult.observe(this._cpuTime, cpuUsage.system, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_SYSTEM,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n      observableResult.observe(this._cpuTime, cpuUsage.idle, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_IDLE,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n      observableResult.observe(this._cpuTime, cpuUsage.interrupt, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_INTERRUPT,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n      observableResult.observe(this._cpuTime, cpuUsage.nice, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_NICE,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n\n      observableResult.observe(this._cpuUtilization, cpuUsage.userP, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_USER,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n      observableResult.observe(this._cpuUtilization, cpuUsage.systemP, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_SYSTEM,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n      observableResult.observe(this._cpuUtilization, cpuUsage.idleP, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_IDLE,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n      observableResult.observe(this._cpuUtilization, cpuUsage.interruptP, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_INTERRUPT,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n      observableResult.observe(this._cpuUtilization, cpuUsage.niceP, {\n        [ATTR_SYSTEM_CPU_STATE]: SYSTEM_CPU_STATE_VALUE_NICE,\n        [ATTR_SYSTEM_CPU_LOGICAL_NUMBER]: cpuUsage.cpuNumber,\n      });\n    }\n  }\n\n  private _batchUpdateProcessCpuUsages(\n    observableResult: BatchObservableResult,\n    processCpuUsage: ProcessCpuUsageData\n  ): void {\n    observableResult.observe(this._processCpuTime, processCpuUsage.user, {\n      [ATTR_PROCESS_CPU_STATE]: PROCESS_CPU_STATE_VALUE_USER,\n    });\n    observableResult.observe(this._processCpuTime, processCpuUsage.system, {\n      [ATTR_PROCESS_CPU_STATE]: PROCESS_CPU_STATE_VALUE_SYSTEM,\n    });\n\n    observableResult.observe(\n      this._processCpuUtilization,\n      processCpuUsage.userP,\n      {\n        [ATTR_PROCESS_CPU_STATE]: PROCESS_CPU_STATE_VALUE_USER,\n      }\n    );\n    observableResult.observe(\n      this._processCpuUtilization,\n      processCpuUsage.systemP,\n      {\n        [ATTR_PROCESS_CPU_STATE]: PROCESS_CPU_STATE_VALUE_SYSTEM,\n      }\n    );\n  }\n\n  private _batchUpdateMemUsages(\n    observableResult: BatchObservableResult,\n    memUsage: MemoryData\n  ): void {\n    observableResult.observe(this._memoryUsage, memUsage.used, {\n      [ATTR_SYSTEM_MEMORY_STATE]: SYSTEM_MEMORY_STATE_VALUE_USED,\n    });\n    observableResult.observe(this._memoryUsage, memUsage.free, {\n      [ATTR_SYSTEM_MEMORY_STATE]: SYSTEM_MEMORY_STATE_VALUE_FREE,\n    });\n\n    observableResult.observe(this._memoryUtilization, memUsage.usedP, {\n      [ATTR_SYSTEM_MEMORY_STATE]: SYSTEM_MEMORY_STATE_VALUE_USED,\n    });\n    observableResult.observe(this._memoryUtilization, memUsage.freeP, {\n      [ATTR_SYSTEM_MEMORY_STATE]: SYSTEM_MEMORY_STATE_VALUE_FREE,\n    });\n  }\n\n  private _batchUpdateProcessMemUsage(\n    observableResult: BatchObservableResult,\n    memoryUsage: number\n  ): void {\n    observableResult.observe(this._processMemoryUsage, memoryUsage);\n  }\n\n  private _batchUpdateNetworkData(\n    observableResult: BatchObservableResult,\n    networkUsages: Systeminformation.NetworkStatsData[]\n  ): void {\n    for (let i = 0, j = networkUsages.length; i < j; i++) {\n      const networkUsage = networkUsages[i];\n      observableResult.observe(this._networkDropped, networkUsage.rx_dropped, {\n        [ATTR_SYSTEM_DEVICE]: networkUsage.iface,\n        [ATTR_NETWORK_IO_DIRECTION]: NETWORK_IO_DIRECTION_VALUE_RECEIVE,\n      });\n      observableResult.observe(this._networkDropped, networkUsage.tx_dropped, {\n        [ATTR_SYSTEM_DEVICE]: networkUsage.iface,\n        [ATTR_NETWORK_IO_DIRECTION]: NETWORK_IO_DIRECTION_VALUE_TRANSMIT,\n      });\n\n      observableResult.observe(this._networkErrors, networkUsage.rx_errors, {\n        [ATTR_SYSTEM_DEVICE]: networkUsage.iface,\n        [ATTR_NETWORK_IO_DIRECTION]: NETWORK_IO_DIRECTION_VALUE_RECEIVE,\n      });\n      observableResult.observe(this._networkErrors, networkUsage.tx_errors, {\n        [ATTR_SYSTEM_DEVICE]: networkUsage.iface,\n        [ATTR_NETWORK_IO_DIRECTION]: NETWORK_IO_DIRECTION_VALUE_TRANSMIT,\n      });\n\n      observableResult.observe(this._networkIo, networkUsage.rx_bytes, {\n        [ATTR_SYSTEM_DEVICE]: networkUsage.iface,\n        [ATTR_NETWORK_IO_DIRECTION]: NETWORK_IO_DIRECTION_VALUE_RECEIVE,\n      });\n      observableResult.observe(this._networkIo, networkUsage.tx_bytes, {\n        [ATTR_SYSTEM_DEVICE]: networkUsage.iface,\n        [ATTR_NETWORK_IO_DIRECTION]: NETWORK_IO_DIRECTION_VALUE_TRANSMIT,\n      });\n    }\n  }\n\n  /**\n   * Creates metrics\n   */\n  protected _createMetrics(): void {\n    const observables = [];\n\n    const systemCpuGroupEnabled =\n      !this._metricGroups || this._metricGroups.includes('system.cpu');\n    const systemMemoryGroupEnabled =\n      !this._metricGroups || this._metricGroups.includes('system.memory');\n    const systemNetworkGroupEnabled =\n      !this._metricGroups || this._metricGroups.includes('system.network');\n    const processCpuGroupEnabled =\n      !this._metricGroups || this._metricGroups.includes('process.cpu');\n    const processMemoryGroupEnabled =\n      !this._metricGroups || this._metricGroups.includes('process.memory');\n\n    if (systemCpuGroupEnabled) {\n      this._cpuTime = this._meter.createObservableCounter(\n        METRIC_SYSTEM_CPU_TIME,\n        {\n          description: 'Cpu time in seconds',\n          unit: 's',\n        }\n      );\n      observables.push(this._cpuTime);\n      this._cpuUtilization = this._meter.createObservableGauge(\n        METRIC_SYSTEM_CPU_UTILIZATION,\n        {\n          description: 'Cpu usage time 0-1',\n        }\n      );\n      observables.push(this._cpuUtilization);\n    }\n\n    if (systemMemoryGroupEnabled) {\n      this._memoryUsage = this._meter.createObservableGauge(\n        METRIC_SYSTEM_MEMORY_USAGE,\n        {\n          description: 'Memory usage in bytes',\n        }\n      );\n      observables.push(this._memoryUsage);\n      this._memoryUtilization = this._meter.createObservableGauge(\n        METRIC_SYSTEM_MEMORY_UTILIZATION,\n        {\n          description: 'Memory usage 0-1',\n        }\n      );\n      observables.push(this._memoryUtilization);\n    }\n\n    if (systemNetworkGroupEnabled) {\n      this._networkDropped = this._meter.createObservableCounter(\n        // There is no semconv pkg export for this in v1.37.0 because\n        // https://github.com/open-telemetry/semantic-conventions/issues/2828.\n        // TODO: update to `METRIC_SYSTEM_NETWORK_PACKET_DROPPED` (breaking change)\n        'system.network.dropped',\n        {\n          description: 'Network dropped packets',\n        }\n      );\n      observables.push(this._networkDropped);\n      this._networkErrors = this._meter.createObservableCounter(\n        METRIC_SYSTEM_NETWORK_ERRORS,\n        {\n          description: 'Network errors counter',\n        }\n      );\n      observables.push(this._networkErrors);\n      this._networkIo = this._meter.createObservableCounter(\n        METRIC_SYSTEM_NETWORK_IO,\n        {\n          description: 'Network transmit and received bytes',\n        }\n      );\n      observables.push(this._networkIo);\n    }\n\n    if (processCpuGroupEnabled) {\n      this._processCpuTime = this._meter.createObservableCounter(\n        METRIC_PROCESS_CPU_TIME,\n        {\n          description: 'Process Cpu time in seconds',\n          unit: 's',\n        }\n      );\n      observables.push(this._processCpuTime);\n      this._processCpuUtilization = this._meter.createObservableGauge(\n        METRIC_PROCESS_CPU_UTILIZATION,\n        {\n          description: 'Process Cpu usage time 0-1',\n        }\n      );\n      observables.push(this._processCpuUtilization);\n    }\n    if (processMemoryGroupEnabled) {\n      this._processMemoryUsage = this._meter.createObservableGauge(\n        METRIC_PROCESS_MEMORY_USAGE,\n        {\n          description: 'Process Memory usage in bytes',\n        }\n      );\n      observables.push(this._processMemoryUsage);\n    }\n\n    this._meter.addBatchObservableCallback(async observableResult => {\n      if (systemCpuGroupEnabled) {\n        const cpuUsages = getCpuUsageData();\n        this._batchUpdateCpuUsages(observableResult, cpuUsages);\n      }\n      if (systemMemoryGroupEnabled) {\n        const memoryUsages = getMemoryData();\n        this._batchUpdateMemUsages(observableResult, memoryUsages);\n      }\n      if (processCpuGroupEnabled) {\n        const processCpuUsages = getProcessCpuUsageData();\n        this._batchUpdateProcessCpuUsages(observableResult, processCpuUsages);\n      }\n      if (processMemoryGroupEnabled) {\n        const processMemoryUsages = getProcessMemoryData();\n        this._batchUpdateProcessMemUsage(observableResult, processMemoryUsages);\n      }\n      if (systemNetworkGroupEnabled) {\n        const networkData = await getNetworkData();\n        this._batchUpdateNetworkData(observableResult, networkData);\n      }\n    }, observables);\n  }\n\n  /**\n   * Starts collecting metrics\n   */\n  start() {\n    this._createMetrics();\n  }\n\n  // The metrics are created in `_createMetrics`.\n  private _cpuTime!: ObservableCounter;\n  private _cpuUtilization!: ObservableGauge;\n  private _memoryUsage!: ObservableGauge;\n  private _memoryUtilization!: ObservableGauge;\n  private _processCpuTime!: ObservableCounter;\n  private _processCpuUtilization!: ObservableGauge;\n  private _processMemoryUsage!: ObservableGauge;\n  private _networkDropped!: ObservableCounter;\n  private _networkErrors!: ObservableCounter;\n  private _networkIo!: ObservableCounter;\n}\n"]}