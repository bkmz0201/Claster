"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createIsolation = createIsolation;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_2 = require("jotai/react");
const utils_1 = require("jotai/react/utils");
const vanilla_1 = require("jotai/vanilla");
function createIsolation() {
    const StoreContext = (0, react_1.createContext)(null);
    function Provider({ store, initialValues = [], children, }) {
        const storeRef = (0, react_1.useRef)(store);
        if (!storeRef.current) {
            storeRef.current = (0, vanilla_1.createStore)();
        }
        (0, utils_1.useHydrateAtoms)(initialValues, { store: storeRef.current });
        return ((0, jsx_runtime_1.jsx)(StoreContext.Provider, { value: storeRef.current, children: children }));
    }
    const useStore = ((options) => {
        const store = (0, react_1.useContext)(StoreContext);
        if (!store)
            throw new Error('Missing Provider from createIsolation');
        return (0, react_2.useStore)(Object.assign({ store }, options));
    });
    const useAtom = ((anAtom, options) => {
        const store = useStore();
        return (0, react_2.useAtom)(anAtom, Object.assign({ store }, options));
    });
    const useAtomValue = ((anAtom, options) => {
        const store = useStore();
        return (0, react_2.useAtomValue)(anAtom, Object.assign({ store }, options));
    });
    const useSetAtom = ((anAtom, options) => {
        const store = useStore();
        return (0, react_2.useSetAtom)(anAtom, Object.assign({ store }, options));
    });
    return { Provider, useStore, useAtom, useAtomValue, useSetAtom };
}
//# sourceMappingURL=createIsolation.js.map